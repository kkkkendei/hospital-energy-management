{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { mapState, mapActions } from 'vuex';\nexport default {\n  name: 'MainLayout',\n  computed: {\n    ...mapState('auth', ['currentUser']),\n    isAdmin() {\n      return this.currentUser && this.currentUser.enabled === true;\n    }\n  },\n  methods: {\n    ...mapActions('auth', ['logout', 'fetchUser']),\n    handleCommand(command) {\n      if (command === 'logout') {\n        this.logout().then(() => {\n          this.$router.push('/login');\n          this.$message.success('已成功退出登录');\n        });\n      } else if (command === 'profile') {\n        // TODO: 跳转到用户个人信息页\n        this.$message.info('功能待开发：个人信息');\n      }\n    }\n  },\n  created() {\n    // 组件创建时尝试从localStorage恢复用户信息\n    if (!this.currentUser) {\n      this.fetchUser();\n    }\n  }\n};","map":{"version":3,"names":["mapState","mapActions","name","computed","isAdmin","currentUser","enabled","methods","handleCommand","command","logout","then","$router","push","$message","success","info","created","fetchUser"],"sources":["src/views/MainLayout.vue"],"sourcesContent":["<template>\r\n  <el-container style=\"height: 100vh;\">\r\n    <el-aside width=\"200px\" style=\"background-color: rgb(238, 241, 246)\">\r\n      <el-menu :default-openeds=\"['1']\" router :default-active=\"$route.path\">\r\n        <el-menu-item index=\"/app/dashboard\">\r\n          <i class=\"el-icon-s-home\"></i>\r\n          <span>仪表盘</span>\r\n        </el-menu-item>\r\n        <el-submenu index=\"1\">\r\n          <template slot=\"title\"><i class=\"el-icon-menu\"></i>能源管理</template>\r\n          <el-menu-item index=\"/app/energy-data-entry\">数据录入</el-menu-item>\r\n          <el-menu-item index=\"/app/energy-data\">能源数据</el-menu-item>\r\n          <el-menu-item index=\"/app/energy-analysis\">能耗分析</el-menu-item>\r\n        </el-submenu>\r\n        <el-menu-item index=\"/app/devices\">\r\n          <i class=\"el-icon-setting\"></i>\r\n          <span>设备管理</span>\r\n        </el-menu-item>\r\n        <!-- 只有管理员可见的用户管理菜单 -->\r\n        <el-menu-item v-if=\"isAdmin\" index=\"/app/user-management\">\r\n          <i class=\"el-icon-user\"></i>\r\n          <span>用户管理</span>\r\n        </el-menu-item>\r\n      </el-menu>\r\n    </el-aside>\r\n\r\n    <el-container>\r\n      <el-header style=\"text-align: right; font-size: 12px; border-bottom: 1px solid #eee; display: flex; align-items: center; justify-content: space-between;\">\r\n        <span>医院能源管理系统</span>\r\n        <div>\r\n          <el-dropdown @command=\"handleCommand\">\r\n            <i class=\"el-icon-setting\" style=\"margin-right: 15px\"></i>\r\n            <el-dropdown-menu slot=\"dropdown\">\r\n              <el-dropdown-item command=\"profile\">个人信息</el-dropdown-item>\r\n              <el-dropdown-item command=\"logout\" divided>退出登录</el-dropdown-item>\r\n            </el-dropdown-menu>\r\n          </el-dropdown>\r\n          <span>{{ currentUser ? currentUser.username : '用户' }}</span>\r\n        </div>\r\n      </el-header>\r\n\r\n      <el-main>\r\n        <router-view /> <!-- 子路由的视图将在这里渲染 -->\r\n      </el-main>\r\n    </el-container>\r\n  </el-container>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapActions } from 'vuex';\r\n\r\nexport default {\r\n  name: 'MainLayout',\r\n  computed: {\r\n    ...mapState('auth', ['currentUser']),\r\n    isAdmin() {\r\n      return this.currentUser && this.currentUser.enabled === true;\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions('auth', ['logout', 'fetchUser']),\r\n    handleCommand(command) {\r\n      if (command === 'logout') {\r\n        this.logout().then(() => {\r\n          this.$router.push('/login');\r\n          this.$message.success('已成功退出登录');\r\n        });\r\n      } else if (command === 'profile') {\r\n        // TODO: 跳转到用户个人信息页\r\n        this.$message.info('功能待开发：个人信息');\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    // 组件创建时尝试从localStorage恢复用户信息\r\n    if (!this.currentUser) {\r\n      this.fetchUser();\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.el-header {\r\n  background-color: #B3C0D1;\r\n  color: #333;\r\n  line-height: 60px;\r\n}\r\n\r\n.el-aside {\r\n  color: #333;\r\n}\r\n.el-menu {\r\n  border-right: none; /* 移除默认的右边框 */\r\n}\r\n</style> "],"mappings":";AAiDA,SAAAA,QAAA,EAAAC,UAAA;AAEA;EACAC,IAAA;EACAC,QAAA;IACA,GAAAH,QAAA;IACAI,QAAA;MACA,YAAAC,WAAA,SAAAA,WAAA,CAAAC,OAAA;IACA;EACA;EACAC,OAAA;IACA,GAAAN,UAAA;IACAO,cAAAC,OAAA;MACA,IAAAA,OAAA;QACA,KAAAC,MAAA,GAAAC,IAAA;UACA,KAAAC,OAAA,CAAAC,IAAA;UACA,KAAAC,QAAA,CAAAC,OAAA;QACA;MACA,WAAAN,OAAA;QACA;QACA,KAAAK,QAAA,CAAAE,IAAA;MACA;IACA;EACA;EACAC,QAAA;IACA;IACA,UAAAZ,WAAA;MACA,KAAAa,SAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}